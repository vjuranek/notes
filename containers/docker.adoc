= Docker

== Useful commands

* `docker container exec  -it $CONATINER_NAME /bin/bash` - run shell inside running container
* `docker rm `docker ps -a -q`` - remove all containers
* `docker inspect -f {{.NetworkSettings.Networks.docker_default.IPAddress}} $CONTAINER_ID` - shows IP address of the container

== Network

* `docker network ls` - list docker networks
* `docker run -it --rm --name mycontainer --link $CONTAINER_NAME --net $NETWOTK_NAME ...` - links to conatiner in given network

== Images

* `docker image prune -a --force --filter "until=2022-08-01T00:00:00"` - prune images older than specified date

== Isseus

=== OOM

Failure:

```
===> Launching kafka ... 
library initialization failed - unable to allocate file descriptor table - out of memorylibrary initialization failed - unable to allocate file descriptor table - out of memoryAborted (core dumped)
```

Fix:

* add `--default-ulimit nofile=65536:65536` to `ExecStart` command into `docker.service` file:

```
ExecStart=/usr/bin/dockerd --default-ulimit nofile=65536:65536 -H fd:// --containerd=/run/containerd/containerd.sock
```

follewed by `systemctl daemon-reload` and `systemctl restart docker`
